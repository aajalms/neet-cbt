<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NEET CBT</title>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #f4f4f4;
}

.header {
  background: #003366;
  color: white;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.container {
  display: flex;
}

.main {
  width: 70%;
  padding: 20px;
  background: white;
}

.palette {
  width: 30%;
  padding: 20px;
  background: #fafafa;
  border-left: 1px solid #ccc;
}

.palette button {
  width: 40px;
  height: 40px;
  margin: 4px;
}

.green { background: #27ae60; color: white; }
.red { background: #e74c3c; color: white; }

button {
  padding: 6px 10px;
  margin: 4px;
}
</style>
</head>

<body>

<div class="header">
  <div>NEET CBT</div>
  <button onclick="enterFullscreen()">Enter Fullscreen</button>
  <div>Time: <span id="timer">180:00</span></div>
</div>

<div class="container">
  <div class="main">
    <h3 id="qno"></h3>
    <p id="qtext"></p>
    <div id="options"></div>

    <button onclick="prev()">Previous</button>
    <button onclick="next()">Next</button>
    <button onclick="submitExam()">Submit Exam</button>
  </div>

  <div class="palette">
    <h4>Question Palette</h4>
    <div id="palette"></div>
  </div>
</div>

<script src="questions.js"></script>

<script>
function enterFullscreen() {
  var el = document.documentElement;
  if (el.requestFullscreen) el.requestFullscreen();
}

var current = 0;
var answers = new Array(questions.length).fill(null);

function loadQuestion() {
  document.getElementById("qno").innerText = "Question " + (current + 1);
  document.getElementById("qtext").innerText = questions[current].q;

  var html = "";
  for (var i = 0; i < questions[current].options.length; i++) {
    var checked = answers[current] === i ? "checked" : "";
    html += '<label><input type="radio" name="opt" value="'+i+'" '+checked+'> ' +
            questions[current].options[i] + '</label><br>';
  }
  document.getElementById("options").innerHTML = html;
  updatePalette();
}

function saveAnswer() {
  var sel = document.querySelector('input[name="opt"]:checked');
  if (sel) answers[current] = Number(sel.value);
}

function next() {
  saveAnswer();
  if (current < questions.length - 1) {
    current++;
    loadQuestion();
  }
}

function prev() {
  saveAnswer();
  if (current > 0) {
    current--;
    loadQuestion();
  }
}

function updatePalette() {
  var p = document.getElementById("palette");
  p.innerHTML = "";
  for (let i = 0; i < questions.length; i++) {
    let b = document.createElement("button");
    b.innerText = i + 1;
    b.className = answers[i] !== null ? "green" : "red";
    b.onclick = function () {
      saveAnswer();
      current = i;
      loadQuestion();
    };
    p.appendChild(b);
  }
}

function submitExam() {
  saveAnswer();
  sessionStorage.setItem("answers", JSON.stringify(answers));
  location.href = "result.html";
}

/* TIMER */
var timeLeft = 180 * 60;
setInterval(function () {
  var m = Math.floor(timeLeft / 60);
  var s = timeLeft % 60;
  document.getElementById("timer").innerText =
    m + ":" + (s < 10 ? "0" : "") + s;
  timeLeft--;
  if (timeLeft < 0) submitExam();
}, 1000);

loadQuestion();
</script>

</body>
</html>
